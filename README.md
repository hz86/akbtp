# akbtp
秋叶原之旅加强版-DATA解包

```
fix为插件
eboot注入插件目的是实现自定义编码转换为ucs2编码



修改 0017D588 启动线程到自己的接口
新启动入口 0x00006838 = 0x0880A838


$a1 = 启动线程的回调
修改a1的数值为 0x00006838 = 0x08804000 + 0x6838

loc_0017D580:		; Refs: 0x0017D56C 
	0x0017D580: 0x3C110000 '...<' - lui        $s1, 0x0
	0x0017D584: 0x26256838 '8h%&' - addiu      $a1, $s1, 26680
	0x0017D588: 0x0C07E6F9 '....' - jal        sceKernelCreateThread

清理掉原有函数代码 6828开始 大小260字节
修改为默认直接返回

sub_00006828:		; Refs: 0x00006680 
	0x00006828: 0x03E00008 '....' - jr         $ra
	0x0000682C: 0x00000000 '....' - nop        
	0x00006830: 0x00000000 '....' - nop        
	0x00006834: 0x00000000 '....' - nop    

这是新的主线程入口
先加载插件，然后调用旧的线程入口
6828原来存在2个重定位。正好给下面2个sub使用了
重定位表内，将原地址改为 6840,6848

sub_00006838:		; Refs: 0x0017D584 
	0x00006838: 0x27BDFFF8 '...'' - addiu      $sp, $sp, -8
	0x0000683C: 0xAFBF0004 '....' - sw         $ra, 4($sp)
	0x00006840: 0x0C001A18 '....' - jal        sub_00006860
	0x00006844: 0x00000000 '....' - nop        
	0x00006848: 0x0C05F576 'v...' - jal        sub_0017D5D8
	0x0000684C: 0x00000000 '....' - nop        
	0x00006850: 0x8FBF0004 '....' - lw         $ra, 4($sp)
	0x00006854: 0x03E00008 '....' - jr         $ra
	0x00006858: 0x27BD0008 '...'' - addiu      $sp, $sp, 8
	0x0000685C: 0x00000000 '....' - nop        


这里为载入插件的代码
$a0 = 插件路径，强制写死
sub_089FDCFC = sceKernelLoadModule   没修改重定向表-强制写死
loc_089FDCEC = sceKernelStartModule  没修改重定向表-强制写死


sub_00006860:		; Refs: 0x00006840 
	0x00006860: 0x27BDFFF8 '...'' - addiu      $sp, $sp, -8
	0x00006864: 0x3C040881 '...<' - lui        $a0, 0x881
	0x00006868: 0x2484A8A0 '...$' - addiu      $a0, $a0, -22368
	0x0000686C: 0x00002821 '!(..' - move       $a1, $zr
	0x00006870: 0xAFBF0004 '....' - sw         $ra, 4($sp)
	0x00006874: 0x0E27F73F '?.'.' - jal        sub_089FDCFC
	0x00006878: 0x00003021 '!0..' - move       $a2, $zr
	0x0000687C: 0x00402021 '! @.' - move       $a0, $v0
	0x00006880: 0x8FBF0004 '....' - lw         $ra, 4($sp)
	0x00006884: 0x00002821 '!(..' - move       $a1, $zr
	0x00006888: 0x00003021 '!0..' - move       $a2, $zr
	0x0000688C: 0x00003821 '!8..' - move       $a3, $zr
	0x00006890: 0x00004021 '!@..' - move       $t0, $zr
	0x00006894: 0x0A27F73B ';.'.' - j          loc_089FDCEC
	0x00006898: 0x27BD0008 '...'' - addiu      $sp, $sp, 8
	0x0000689C: 0x00000000 '....' - nop        
	0x000068A0: 0x63736964 'disc' - Unknown    
	0x000068A4: 0x502F3A30 '0:/P' - beql       $at, $t7, loc_00015168
	0x000068A8: 0x475F5053 'SP_G' - Unknown    
	0x000068AC: 0x2F454D41 'AME/' - sltiu      $a1, $k0, 19777
	0x000068B0: 0x44535953 'SYSD' - Unknown    
	0x000068B4: 0x462F5249 'IR/F' - Unknown    
	0x000068B8: 0x502E5849 'IX.P' - beql       $at, $t6, loc_0001C9E0
	0x000068BC: 0x00005852 'RX..' - Unknown    
	0x000068C0: 0x00000000 '....' - nop        
	0x000068C4: 0x00000000 '....' - nop        
	0x000068C8: 0x00000000 '....' - nop        
	0x000068CC: 0x00000000 '....' - nop        
	0x000068D0: 0x00000000 '....' - nop        
	0x000068D4: 0x00000000 '....' - nop        
	0x000068D8: 0x00000000 '....' - nop        
	0x000068DC: 0x00000000 '....' - nop        
	0x000068E0: 0x00000000 '....' - nop        
	0x000068E4: 0x00000000 '....' - nop        
	0x000068E8: 0x00000000 '....' - nop        
	0x000068EC: 0x00000000 '....' - nop        
	0x000068F0: 0x00000000 '....' - nop        
	0x000068F4: 0x00000000 '....' - nop        
	0x000068F8: 0x00000000 '....' - nop        
	0x000068FC: 0x00000000 '....' - nop        
	0x00006900: 0x00000000 '....' - nop        
	0x00006904: 0x00000000 '....' - nop        
	0x00006908: 0x00000000 '....' - nop        
	0x0000690C: 0x00000000 '....' - nop        
	0x00006910: 0x00000000 '....' - nop        
	0x00006914: 0x00000000 '....' - nop        
	0x00006918: 0x00000000 '....' - nop        
	0x0000691C: 0x00000000 '....' - nop        
	0x00006920: 0x00000000 '....' - nop        
	0x00006924: 0x00000000 '....' - nop        
	0x00006928: 0x00000000 '....' - nop        


```